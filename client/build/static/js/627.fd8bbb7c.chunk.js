"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[627],{627:(e,t,a)=>{a.r(t),a.d(t,{default:()=>o});var s=a(555),l=a(43),n=a(265),r=a(505),i=a(722),d=a(579);function o(){const[e,t]=(0,l.useState)(null),[a,o]=(0,l.useState)({title:"",song_cover_url:"",artist_id:"",audio:null,genre:"Pop"}),[c,u]=(0,l.useState)([]),[m,h]=(0,l.useState)(!1),p=(0,n.Zp)();(0,l.useEffect)((()=>{(async()=>{const a=sessionStorage.getItem("token");if(a)try{const e=await i.A.get(r.y+"/artists",{headers:{Authorization:"Token ".concat(a)}});u(e.data)}catch(e){t("Failed to load artists: "+e.message)}})()}),[]);const x=e=>{const{name:t,value:a,type:l,files:n}=e.target;o("file"===l?e=>(0,s.A)((0,s.A)({},e),{},{[t]:n[0]}):e=>(0,s.A)((0,s.A)({},e),{},{[t]:a}))};return e?(0,d.jsxs)("p",{className:"text-red-500",children:["Error: ",e]}):(0,d.jsx)("div",{className:"w-full flex items-center justify-center mt-4 mb-20",children:(0,d.jsxs)("div",{className:"bg-cyan-800 p-6 rounded-md shadow-lg w-1/3",children:[(0,d.jsx)("h2",{className:"text-xl mb-4",children:"Create Song"}),(0,d.jsxs)("form",{onSubmit:async s=>{s.preventDefault(),h(!0);const l=sessionStorage.getItem("token");if(!l)return;const n=new FormData;for(let e in a)n.append(e,a[e]);try{await i.A.post(r.y+"/songs/create/",n,{headers:{"Content-Type":"multipart/form-data",Authorization:"Token ".concat(l)}}),alert("Successfully created Song:"),p("/songs")}catch(e){var d,o;t((null===(d=e.response)||void 0===d||null===(o=d.data)||void 0===o?void 0:o.detail)||"Something went wrong")}finally{h(!1)}},encType:"multipart/form-data",children:[(0,d.jsxs)("div",{className:"mb-2",children:[(0,d.jsx)("label",{className:"block text-gray-700",children:"Title"}),(0,d.jsx)("input",{type:"text",name:"title",value:a.title,onChange:x,className:"w-full p-1 border rounded-md",required:!0})]}),(0,d.jsxs)("div",{className:"mb-2",children:[(0,d.jsx)("label",{className:"block text-gray-700",children:"Genre"}),(0,d.jsx)("input",{type:"text",name:"genre",value:a.genre,onChange:x,className:"w-full p-1 border rounded-md",required:!0})]}),(0,d.jsxs)("div",{className:"mb-2",children:[(0,d.jsx)("label",{className:"block text-gray-700",children:"Artist"}),(0,d.jsxs)("select",{name:"artist_id",value:a.artist_id,onChange:x,className:"w-full p-1 border rounded-md",required:!0,children:[(0,d.jsx)("option",{value:"",children:"Select Artist"}),c.map((e=>(0,d.jsx)("option",{value:e.id,children:e.name},e.id)))]})]}),(0,d.jsxs)("div",{className:"mb-2",children:[(0,d.jsx)("label",{className:"block text-gray-700",children:"Audio File"}),(0,d.jsx)("input",{type:"file",name:"audio",accept:"audio/*",onChange:x,className:"w-full p-1 border rounded-md",required:!0})]}),(0,d.jsxs)("div",{className:"mb-2",children:[(0,d.jsx)("label",{className:"block text-gray-700",children:"Song Cover URL"}),(0,d.jsx)("input",{type:"text",name:"song_cover_url",value:a.song_cover_url,onChange:x,className:"w-full p-1 border rounded-md",required:!0})]}),(0,d.jsx)("button",{type:"submit",className:"w-full p-2 bg-blue-500 text-white rounded-md",disabled:m,children:m?"Uploading...":"Submit"})]})]})})}}}]);
//# sourceMappingURL=627.fd8bbb7c.chunk.js.map